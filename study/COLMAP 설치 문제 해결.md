# COLMAP 설치 문제 해결 
2D 이미지를 3D 모델로 변환해주는 `COLMAP` 프로그램을 설치해보았다.
사실 설치하여 실행하는 것부터 난관이 있었는데, 문제의 원인은 커널 버전과 엔비디아 드라이버간의 호환성 문제로 추정된다. 

### 해결 노트
- COLMAP의 dense reconstruction 단계는 CUDA를 지원하는 GPU에서만 가동 가능하다.
- 그런데 내가 COLMAP 설치 당시, 커널(6.18)과 nvidia 드라이버가 호환이 안되어 nvidia 그래픽카드가 인식되지 않는 문제가 있었다.
  - Ubuntun 22.04 에 가장 안정적인 커널은 6.8인데, 예전에 블루투스 문제를 해결하려다가 엄청 최신 커널을 설치하게 된 것 같다.
- 이에 커널을 6.8로 다운그레이드 후 nvidia 드라이버를 재설치하여 해결되었다.
  - 다운그레이드 과정에서 GRUB 접속이 잘 되지 않아 `/etc/default/grub`의 내용을 수정하여 부팅될 때 약 10초간 `Advanced options for Ubuntu`에 접속할 수 있게 했다.
  - nvidia 드라이버를 재설치해야하는 이유는 nvidia 드라이버가 설치될 때 현재 실행 중인 커널에 맞추어 커널 모듈을 빌드하기 때문이다.  
- 또한 그래픽 설정을 Discrete Graphics(외장 그래픽)만 사용하게 하여 항상 nvidia gpu를 사용하도록 했다.
  - COLMAP을 구동할 때만 nvidia gpu를 사용하게 하는 것도 방법이지만 일반적인 작업을 할 때 발열이 심하지 않은 것 같다.
 
### 회고 
youtube에서 COLMAP 튜토리얼 영상 보고 음? 금방 끝나겠는데? 싶었으나 역시 직접 해보는 게 중요하다.
