# Ubuntu 22.04(Mediatek7925e 콤보카드)에서 블루투스 자체가 켜지지 않는 문제 해결

### 배경
로봇 개발의 표준 프레임워크인 ROS는 Linux와 호환되고 MacOS를 지원하지 않아, 이번에 Linux 체제를 지원하는 Lenovo의 Legion 5 를 구매하게 되었다. 또한 두산 Rokey 캠프의 커리큘럼상 Ubuntu 22.04 를 설치해야해서 해당 버전을 설치했다(가장 최신 버전은 Ubuntu 24.04 LTS이라고 한다).

### 본론 
어찌저찌 도움을 받아 Ubuntu 22.04 버전까지는 설치했다. 그런데 **블루투스 자체가 켜지지 않는 현상**이 있었다. 그러니까 블루투스 장치의 신호조차 알 수 없게 이 노트북의 블루투스가 켜지지 않았다. 
이를 해결하고자 Gemini에게 물어보고 Reddit을 구글링했는데 여러 해결 방법들이 먹히지 않았다. 아래는 내가 시도한 것들이다.


```bash
rfkill list 
``` 
이런 명령어로 Bluetooth 항목이 Block 되어있는지 확인해본다거나, 

```bash
sudo dmesg | grep -i bluetooth 
```
커널 관련 어떤 로그들이 있는지 확인한다거나. 

```bash
sudo modprobe -r btsub
sudo modprobe btusb
``` 
커널 모듈을 재설치한다거나, 

그리고 이런 로그를 복사하여 다시 Gemini 에게 도움을 청했으나 모든 해결책이 먹히지 않았다. 간헐적으로 블루투스 On에 성공했던 건:
```bash
sudo modprobe -r btusb mt7925e && sleep 10 && sudo modprobe mt7925e && sudo modprobe btusb && sudo systemctl restart bluetooth
``` 
이런 명령어였다. 그런데 이마저도 절전모드가 되거나 컴퓨터가 재부팅되면 해당 명령어를 실행해도 효과가 없었다. </br>
한동안 유선 마우스를 사용하며 블루투스 사용을 포기하거나, 블루투스 동글을 사서 쓸까 고민했지만 집착적으로 찾아낸 결과 나와 비슷한 문제를 겪은 사람이 해결한 방법을 발견했다!
Ubuntu, Mediatek, Bluetooth 등 여러 키워드를 조합하여 구글링한 결과 이 [커뮤니티 글](https://discussion.fedoraproject.org/t/bluetooth-mt7925e-doesnt-work-anymore-after-an-update-on-fedora-workstation-42/164707/8)을 발견했고, 해당 글에서 [해결 방법](https://github.com/LuanAdemi/mediatek7925e-bluetooth-fix)을 적용해보았더니 완벽하게 해결되었다! 

### 문제의 원인
MediatTek 라는 제조사의 와이파이, 블루투스 콤보카드(mt7925e)가 리눅스 시스템에서 블루투스 컨트럴러로 인식되지 않는 게 원인이었다.Gemini의 말을 빌리자면, 
> 알고 보니 내 노트북에 탑재된 최신 MediaTek 칩셋이 우분투 리눅스에게 자신을 '블루투스 장치'가 아닌 엉뚱한 장치로 소개하고 있었다. 내가 찾은 해결책은 이 녀석에게 강제로 '너는 블루투스야!'라고 명찰을 달아주는 스크립트였다. 하드웨어의 신원(ID)을 강제로 드라이버와 매핑시켜주는 과정을 통해 비로소 블루투스 기능이 정상 작동했다.

### 회고
지금까지는 GUI 기반의, 굉장히 하이레벨단에서 컴퓨터를 사용해와서 관심도 없고 잘 몰랐는데(애초에 맥북을 쓰면서 기본적인 블루투스 연결이 안되는 경험은 발생할 수 없는 일이었다만...) 이 컴퓨터가 어떻게 동작하는지 로우레벨 수준으로 이해하는 게 중요하다는 걸 깨달은 만큼 좋은 경험이라고 생각한다. 비록 이 노트북을 처음 개시한 날 거의 밤을 새가며 꾸부정한 자세로 문제와 다투느라 힘들었지만... 적절한 스트레스는 사람에게 활력을 준다.

##### Gemini 가 초기에 잘 잡아낸 것: 
- MediatTek MT7925 Wi-Fi/Bluetooth 콤보 카드가 Ubuntu Linux 환경에서 문제를 자주 일으키는 장치라는 사실을 짚어준 것. 

##### Gemini 가 못해준 것: 
- 실제 해결책을 찾아주지 못한 것.

##### 내가 잘한 것: 
- 각고의 시도 끝에 문제를 해결해낸 것.
- 그 과정에서 의도치 않게 리눅스 체제의 명령어에 일부 익숙해진 것.
예를 들어 `sudo` 는 일종의 super 권한을 가진 명령어라는 것. 외계어처럼 들려서 무섭던 명령어나 디렉토리 경로, 구조가 익숙해졌다. 

##### 내가 못한 것: 
- Gemini가 힌트를 줬음에도 하드웨어(커널, 콤보 카드 등)의 구성을 직접 이해하려고 하지 않은 것. 
